function wfnmat = integratewfn(da,phi,theta,wfnGrid,Ngrid,Nbasis)    ds = sin(theta)*2*da^2;  ds(ds==0) = 0.00000001;    dsvec = reshape(ds,[1,Ngrid^2]);    wfnmat = zeros(Ngrid^2,Nbasis^2);    %Integrate the wavefunction   for i=1:Nbasis^2    for j=0:(Ngrid^2-1)      wfnGridvec = wfnGrid(i,:);      subwfnGridvec = wfnGridvec(1,(1+j*Ngrid^2):(1+j)*Ngrid^2);%creating submvectors of the original Ngrid^4 by 1 vector in order to separate the varying theta1 and  phi1 with constant theta2 and phi2            wfnelement = dsvec.*subwfnGridvec;      wfnvec(j+1) = sum(wfnelement);%riemann sum for the integral          end    wfnmat(:,i) = wfnvec.^2;  end  end